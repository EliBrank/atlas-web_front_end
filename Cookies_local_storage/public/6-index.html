<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookies 06</title>

    <style>
    </style>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const availableItems = [
          'Shampoo',
          'Soap',
          'Sponge',
          'Water'
        ];

        function sessionStorageAvailable() {
          const test = 'test';

          try {
            sessionStorage.setItem(test, test);
            sessionStorage.removeItem(test, test);

            return true;
          } catch(error) {
            alert('Sorry, your browser does not support Web storage. Try again with a better one');
            return false;
          }
        }

        function addItemToCart(item) {
          sessionStorage.setItem(item, true);
        }

        if (sessionStorageAvailable()) {
          function createStore() {
            const body = document.querySelector('body');
            const store = document.createElement('ul');

            for (const item of availableItems) {
              const listing = document.createElement('li');
              listing.textContent = item;

              listing.addEventListener('click', () => {
                addItemToCart(item);
              });
              store.appendChild(listing);
            }

            body.appendChild(store);
          }

          function displayCart() {
            const cartItems = sessionStorage.length

            if (cartItems > 0) {
              const body = document.querySelector('body');
              const cartItemsNotice = document.createElement('p');
              cartItemsNotice.textContent = `You previously had ${cartItems} items in your cart`;

              body.appendChild(cartItemsNotice);
            }
          }

        }

        createStore();
        displayCart();

      });
    </script>

  </head>
  <body>
  </body>
</html>
